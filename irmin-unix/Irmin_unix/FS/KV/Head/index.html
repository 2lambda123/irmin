<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Head (irmin-unix.Irmin_unix.FS.KV.Head)</title><link rel="stylesheet" href="../../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../../../index.html">irmin-unix</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Irmin_unix.FS.KV.Head</span></h1></header><div class="doc"><p>Managing the store's heads.</p></div><div class="spec val" id="val-list"><a href="#val-list" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>list : <a href="../index.html#type-repo">repo</a> <span class="keyword">&#8209;&gt;</span> <a href="../index.html#type-commit">commit</a> list Lwt.t</code></div><div class="doc"><p><code class="code">list t</code> is the list of all the heads in local store. Similar
to <code class="code">git rev-list --all</code>.</p></div></div><div class="spec val" id="val-find"><a href="#val-find" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>find : <a href="../index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="../index.html#type-commit">commit</a> option Lwt.t</code></div><div class="doc"><p><code class="code">find t</code> is the current head of the store <code class="code">t</code>. This works for
both persistent and temporary branches. In the case of a
persistent branch, this involves getting the the head
associated with the branch, so this may block. In the case of
a temporary store, it simply returns the current head. Returns
<code class="code">None</code> if the store has no contents. Similar to <code class="code">git rev-parse
        HEAD</code>.</p></div></div><div class="spec val" id="val-get"><a href="#val-get" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get : <a href="../index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="../index.html#type-commit">commit</a> Lwt.t</code></div><div class="doc"><p>Same as <a href="index.html#val-find">find</a> but raise <code class="code">Invalid_argument</code> if the store does
not have any contents.</p></div></div><div class="spec val" id="val-set"><a href="#val-set" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>set : <a href="../index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="../index.html#type-commit">commit</a> <span class="keyword">&#8209;&gt;</span> unit Lwt.t</code></div><div class="doc"><p><code class="code">set t h</code> updates <code class="code">t</code>'s contents with the contents of the
commit <code class="code">h</code>. Can cause data loss as it discards the current
contents. Similar to <code class="code">git reset --hard &lt;hash&gt;</code>.</p></div></div><div class="spec val" id="val-fast_forward"><a href="#val-fast_forward" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>fast_forward : <a href="../index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;max_depth:int <span class="keyword">&#8209;&gt;</span> ?&#8288;n:int <span class="keyword">&#8209;&gt;</span> <a href="../index.html#type-commit">commit</a> <span class="keyword">&#8209;&gt;</span> (unit, [ `No_change | `Rejected | <a href="../index.html#type-lca_error">lca_error</a> ]) Result.result Lwt.t</code></div><div class="doc"><p><code class="code">fast_forward t h</code> is similar to update but the <code class="code">t</code>'s head
is updated to <code class="code">h</code> only if <code class="code">h</code> is stricly in the future of
<code class="code">t</code>'s current head. <code class="code">max_depth</code> or <code class="code">n</code> are used to limit the
search space of the lowest common ancestors (see <a href="../index.html#val-lcas">lcas</a>).</p><p>The result is:
</p><ul><li><code class="code">Ok ()</code> if the operation is succesfull;</li><li><code class="code">Error `No_change</code> if <code class="code">h</code> is already <code class="code">t</code>'s head;</li><li><code class="code">Error `Rejected</code> if <code class="code">h</code> is not in the strict future of <code class="code">t</code>'s head.</li><li><code class="code">Error e</code> if the history exploration has been cut before
getting useful results. In that case. the operation can be
retried using different parameters of <code class="code">n</code> and <code class="code">max_depth</code>
to get better results.</li></ul></div></div><div class="spec val" id="val-test_and_set"><a href="#val-test_and_set" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>test_and_set : <a href="../index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> test:<a href="../index.html#type-commit">commit</a> option <span class="keyword">&#8209;&gt;</span> set:<a href="../index.html#type-commit">commit</a> option <span class="keyword">&#8209;&gt;</span> bool Lwt.t</code></div><div class="doc"><p>Same as update_head but check that the value is <code class="code">test</code> before
updating to <code class="code">set</code>. Use update or <a href="index.html#val-merge">merge</a> instead if
possible.</p></div></div><div class="spec val" id="val-merge"><a href="#val-merge" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>merge : into:<a href="../index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> info:<a href="../../../../../irmin/Irmin/Info/index.html#type-f">Irmin.Info.f</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;max_depth:int <span class="keyword">&#8209;&gt;</span> ?&#8288;n:int <span class="keyword">&#8209;&gt;</span> <a href="../index.html#type-commit">commit</a> <span class="keyword">&#8209;&gt;</span> (unit, <a href="../../../../../irmin/Irmin/Merge/index.html#type-conflict">Irmin.Merge.conflict</a>) Result.result Lwt.t</code></div><div class="doc"><p><code class="code">merge ~into:t ?max_head ?n commit</code> merges the contents of the
commit associated to <code class="code">commit</code> into <code class="code">t</code>. <code class="code">max_depth</code> is the
maximal depth used for getting the lowest common ancestor. <code class="code">n</code>
is the maximum number of lowest common ancestors. If present,
<code class="code">max_depth</code> or <code class="code">n</code> are used to limit the search space of the
lowest common ancestors (see <a href="../index.html#val-lcas">lcas</a>).</p></div></div></body></html>